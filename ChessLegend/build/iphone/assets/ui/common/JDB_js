function JDB(){}JDB.prototype.setObj=function(e){this.jobj=e},JDB.prototype.setText=function(e){var s=JSON.parse(e);this.jobj=s},JDB.prototype.saveFile=function(e){var s=Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,e);this.jobj?s?(s.write(JSON.stringify(this.jobj)),Ti.API.info("FileDB saved")):Ti.API.error("File ["+e+"] can not open"):Ti.API.error("Json Object is not available!")},JDB.prototype.loadFile=function(e){var s=Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,e);if(s.exists()){var i=s.read().text,t=JSON.parse(i);t?(this.jobj=t,Ti.API.info("load json obj")):Ti.API.error("json obj is not available")}else{Ti.API.error("File ["+e+"] can not open");var a={};a.games=new Array,this.jobj=a,this.saveFile("fav.json")}},JDB.prototype.addFavorite=function(){var e=myChess.chessObj.game;if(e.create=new Date,this.jobj||this.loadFile("fav.json"),this.jobj){for(var s=-1,i=0;i<this.jobj.games.length;i++){var t=this.jobj.games[i];if(t&&t.Gid==e.Gid){s=i;break}}if(s>-1){for(var a=s+1;a<this.jobj.games.length;a++)this.jobj.games[a-1]=this.jobj.games[a];this.jobj.games.pop()}this.jobj.games.push(e),this.saveFile("fav.json")}},JDB.prototype.delFavorite=function(e){if(this.jobj||this.loadFile("fav.json"),this.jobj){for(var s=-1,i=0;i<this.jobj.games.length;i++){var t=this.jobj.games[i];if(t&&e==t.Gid){s=i;break}}if(s>-1){for(var a=s+1;a<this.jobj.games.length;a++)this.jobj.games[a-1]=this.jobj.games[a];this.jobj.games.pop(),this.saveFile("fav.json")}}},JDB.prototype.loadFavorite=function(){return this.loadFile("fav.json"),this.jobj},JDB.prototype.getTableData=function(){var e=[];for(this.loadFile("fav.json"),Ti.API.info("load json "+this.jobj.games.length),i=0;i<this.jobj.games.length;i++){var s=this.jobj.games.length-1-i,t=this.jobj.games[s],a=t.White,n=t.Black,r="";"?"!=t.Event?r=t.Event:"?"!=t.Site&&(r=t.Site);var h=Ti.UI.createLabel({text:r,textAlign:"left",height:12,width:160,font:{fontSize:13,fontWeight:"normal",fontFamily:"Arial"},color:"#112233",top:2,left:100}),c=Ti.UI.createLabel({text:t.Year,textAlign:"left",height:12,width:50,font:{fontSize:13,fontWeight:"normal",fontFamily:"Arial"},color:"#113322",top:2,left:32}),b=Ti.UI.createLabel({text:a+" vs.  "+n,textAlign:"bottom",height:18,width:250,font:{fontSize:15,fontWeight:"normal",fontFamily:"Arial"},color:color,bottom:3,left:32}),o=Math.floor((Date.parse(new Date)-Date.parse(t.create))/36e5),f=o+" h";o>23&&(o=Math.floor((o+1)/24),f=31>o?o+" d":365>o?Math.floor(o/30)+" m":Math.floor(o/365)+" y");var p=Ti.UI.createLabel({text:f,textAlign:"right",height:16,width:60,font:{fontSize:15,fontWeight:"normal",fontFamily:"Arial"},color:"#001122",top:5,right:20}),u=Ti.UI.createButton({title:"del",top:10,left:5,width:20,height:20,gid:t.Gid,clickName:"delbutton",backgroundImage:Ti.Filesystem.resourcesDirectory+"images/delbutton.png"});u.addEventListener("click",function(){myChess.JDB.delFavorite(this.gid),myChess.Favview.refresh()});var w=Ti.UI.createTableViewRow({backgroundImage:Ti.Filesystem.resourcesDirectory+"images/babooItemf.png",height:39,width:300,left:20,borderWidth:0,index:i,className:"game"});w.add(c),w.add(h),w.add(p),w.add(b),w.add(u),w.Gid=t.Gid,e.push(w)}return Ti.API.info("data size:"+e.length),e},module.exports=JDB;